{
	"name": "load entities",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "adl_raw_customers",
						"type": "DatasetReference"
					},
					"name": "Customers"
				},
				{
					"dataset": {
						"referenceName": "adl_raw_salesperson",
						"type": "DatasetReference"
					},
					"name": "SalesPerson"
				},
				{
					"dataset": {
						"referenceName": "adl_raw_territory",
						"type": "DatasetReference"
					},
					"name": "Territory"
				},
				{
					"dataset": {
						"referenceName": "adl_raw_shipmethod",
						"type": "DatasetReference"
					},
					"name": "ShipMethod"
				},
				{
					"dataset": {
						"referenceName": "adl_raw_product",
						"type": "DatasetReference"
					},
					"name": "Product"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "adl_app_customers",
						"type": "DatasetReference"
					},
					"name": "appcustomers"
				},
				{
					"dataset": {
						"referenceName": "adl_app_salesperson",
						"type": "DatasetReference"
					},
					"name": "appsalesperson"
				},
				{
					"dataset": {
						"referenceName": "adl_app_territory",
						"type": "DatasetReference"
					},
					"name": "appTerritory"
				},
				{
					"dataset": {
						"referenceName": "adl_app_shipmethod",
						"type": "DatasetReference"
					},
					"name": "appShipmethod"
				},
				{
					"dataset": {
						"referenceName": "adl_app_product",
						"type": "DatasetReference"
					},
					"name": "appProduct"
				}
			],
			"transformations": [
				{
					"name": "SurrogateKeyCustomers"
				},
				{
					"name": "SurrogateKeySalesPerson"
				},
				{
					"name": "SurrogateKeyTerritory"
				},
				{
					"name": "SurrogateKeyShipmethod"
				},
				{
					"name": "SurrogateKeyProduct"
				}
			],
			"script": "source(output(\n\t\tCustomerID as integer,\n\t\tPersonID as integer,\n\t\tStoreID as integer,\n\t\tTerritoryID as integer,\n\t\tAccountNumber as string,\n\t\tModifiedDate as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Customers\nsource(output(\n\t\tBusinessEntityID as integer,\n\t\tTerritoryID as integer,\n\t\tSalesQuota as float,\n\t\tBonus as float,\n\t\tCommissionPct as float\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> SalesPerson\nsource(output(\n\t\tTerritoryID as integer,\n\t\tName as string,\n\t\tCountryRegionCode as string,\n\t\tGroup as string,\n\t\tSalesYTD as float,\n\t\tSalesLastYear as float,\n\t\tCostYTD as string,\n\t\tCostLastYear as float,\n\t\trowguid as string,\n\t\tModifiedDate as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Territory\nsource(output(\n\t\tShipMethodID as string,\n\t\tName as string,\n\t\tShipBase as string,\n\t\tShipRate as string,\n\t\trowguid as string,\n\t\tModifiedDate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ShipMethod\nsource(output(\n\t\tProductID as string,\n\t\tName as string,\n\t\tProductNumber as string,\n\t\tMakeFlag as string,\n\t\tFinishedGoodsFlag as string,\n\t\tColor as string,\n\t\tSafetyStockLevel as string,\n\t\tReorderPoint as string,\n\t\tStandardCost as string,\n\t\tListPrice as string,\n\t\tSize as string,\n\t\tSizeUnitMeasureCode as string,\n\t\tWeightUnitMeasureCode as string,\n\t\tWeight as string,\n\t\tDaysToManufacture as string,\n\t\tProductLine as string,\n\t\tClass as string,\n\t\tStyle as string,\n\t\tProductModelID as string,\n\t\tSellStartDate as string,\n\t\tSellEndDate as string,\n\t\tDiscontinuedDate as string,\n\t\tProductCategory as string,\n\t\tProductSubcategory as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Product\nCustomers keyGenerate(output(id_sk_customer as long),\n\tstartAt: 1L) ~> SurrogateKeyCustomers\nSalesPerson keyGenerate(output(id_sk_salesperson as long),\n\tstartAt: 1L) ~> SurrogateKeySalesPerson\nTerritory keyGenerate(output(id_sk_territory as long),\n\tstartAt: 1L) ~> SurrogateKeyTerritory\nShipMethod keyGenerate(output(id_sk_shipmethod as long),\n\tstartAt: 1L) ~> SurrogateKeyShipmethod\nProduct keyGenerate(output(id_sk_product as long),\n\tstartAt: 1L) ~> SurrogateKeyProduct\nSurrogateKeyCustomers sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tCustomerID as integer,\n\t\tPersonID as integer,\n\t\tStoreID as integer,\n\t\tTerritoryID as integer,\n\t\tAccountNumber as string,\n\t\tModifiedDate as timestamp,\n\t\tid_sk_customer as long\n\t),\n\tformat: 'parquet',\n\tpartitionFileNames:['customers.parquet'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> appcustomers\nSurrogateKeySalesPerson sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['salesperson.parquet'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> appsalesperson\nSurrogateKeyTerritory sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['territory.parquet'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> appTerritory\nSurrogateKeyShipmethod sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['shipmethod.parquet'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> appShipmethod\nSurrogateKeyProduct sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['products.parquet'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> appProduct"
		}
	}
}